\input{preamble}

\begin{document}
\frame{\titlepage}

\begin{frame}{Preliminaries - Number fields}
	Let 
	\(
		n= 2^m
	\)
	where $m$ is a positive integer. Our field of coefficients will
	be
	\[
		K_n= \mathbb{Q}[X]/
			\langle
			X^n + 1
			\rangle
	\]
	and its ring of integers is 
	\(
		R_n= \mathbb{Z}[X]/
			\langle
			X^n + 1
			\rangle.
	\)

	\bigskip
	For
	\(
		f \in K_n
	\)
	we write
	\[
		f= f[0] + f[1]X + \cdots + f[n-1]X^{n-1}
	\]
	and its \textbf{conjugate} is given by
	\[
		f^*= f[0] - f[n-1]X - \cdots - f[1]X^{n-1}.
	\]
\end{frame}

% nextframe
\begin{frame}{Preliminaries - Matrices and inner products}
	Given a matrix
	\(
		B \in K_n^{r\times s}
	\)
	its \textbf{Hermitian adjoint} is the matrix $B^*$ obtained by taking the
	conjugate of each entry of $B^{\textsf{t}}$, the transpose of $B$.

	\bigskip
	\bigskip
	\textbf{\large Inner products}

	The inner product on $K_n$ over $\mathbb{Q}$ is defined as
	\[
		\begin{array}{c}
			\encl{\cdot, \cdot} : K_n\times K_n \to \mathbb{Q}\\
			\encl{f, g}=
			\frac{1}{n} \mathrm{Tr}(f^*g).
		\end{array}
	\]
	where $\mathrm{Tr}$ denotes the algebraic trace over the extension
	\(
		K_n/\mathbb{Q}.
	\)

\end{frame}

% nextframe
\begin{frame}{Preliminaries - Matrices and inner products}
	If
	\(
		B \in K_n^{r\times r}
	\)
	is an invertible matrix, then
	\(
		Q= B^*B
	\)
	defines an inner product on $K_n^r$ via
	\[
		\encl{\mathbf{f}, \mathbf{g}}_Q=
		\frac{1}{n}\mathrm{Tr}(
		\mathbf{f}^* Q \mathbf{g}).
	\]
\end{frame}

% nextframe
\begin{frame}{Preliminaries - Some examples}
	Let's take $n= 4$, and let
	\[
		\left\{
		\begin{array}{l}
			f= 1 - 2X + 3X^2 + 4X^3\\
			g= 3 - X^3
		\end{array}
		\right.
	\]
	Then
	\[
		\begin{array}{l}
			f^*g = (1 - 4X - 3X^2 + 2X^3)(3 - X^3)\\
%			(3 - 12X -9X^2 + 6X^3) - (4 + 3X -2X^2 + X^3) =\\
			= -1 - 15X - 7X^2 + 5X^3.
		\end{array}
	\]
	Its matrix representation over $\mathbb{Q}$ in the basis
	\(
		1, X, X^2, X^3
	\)
	is
	\[
		(f^*g)=
		\left(
		\begin{array}{cccc}
			-1 & -5 & 7 & 15\\
			-15 & -1 & -5 & 7\\
			-7 & -15 & -1 & -5\\
			5 & -7 & -15 & -1\\
		\end{array}
	\right)
	\]
	and therefore
	\(
		\encl{f,g} = \frac{1}{4}\mathrm{Tr}(f^*g) = -1.
	\)
\end{frame}

% nextframe
\begin{frame}{Discrete Gaussian Distribution}
	It is well known that the integral
	\[
		\int_{-\infty}^\infty \exp(-\alpha x^2) dx
	\]
	converges for all positive constants $\alpha$.
	
	Consequently, the associated series
	\[
		\sum_{x \in \mathbb{Z}} \exp(-\alpha x^2)
	\]
	is convergent.
\end{frame}

% nextframe
\begin{frame}{Discrete Gaussian Distribution}
	Given a positive real constant $\sigma$, let
	\[
		\rho_\sigma(x)= \gdens{\sigma}{x}
	\]
	Then for any real number $c$ we define the \emph{Discrete Gaussian
	Distribution} on
	\(
		2\mathbb{Z} + c
	\)
	with parameter $\sigma$, denoted
	\(
		D_{2\mathbb{Z} + c, \sigma}
	\)
	by the rule
	\[
		\Pr[X = x]=
		\frac{\rho_\sigma(x)}
		{
			\sum_{z \in 2\mathbb{Z} + c} \rho_\sigma(z)
		}.
	\]

	\bigskip
	For higher dimensions $n > 1$, a sample
	\(
		\mathbf{x} \in 2\mathbb{Z}^n + \mathbf{c}
	\)
	with parameter $\sigma$ is obtained via $n$ independent samples
	\(
		x_i \leftarrow D_{2\mathbb{Z} + c_i}.
	\) 
\end{frame}

% nextframe
\begin{frame}{Structured $\leftrightarrow$ Unstructured}
	\textbf{\large Vectorization of polynomials}

	\medskip
	Given a polynomial
	\(
		f \in K_n
	\)
	we have
	\(
		f = \sum_{i= 0}^{n-1}f[i] X^i
	\)
	where
	\(
		f[i] \in \mathbb{Q}
	\)
	for each $i$.
	
	\bigskip
	Then the map
	\[
		\begin{array}{l}
			\textsf{vec}: K_n \to \mathbb{Q}^n\\
			f \mapsto
			\left[
				\begin{array}{l}
					f[0]\\
					\vdots\\
					f[n-1]
				\end{array}
			\right]
		\end{array}
	\]
	is clearly invertible and its restriction to $R_n$ takes values in
	$\mathbb{Z}^n$.

	This allows us to easily identify polynomials with vectors and vice-versa.
\end{frame}

% nextframe
\begin{frame}{Preliminaries - Some examples}
	Consider the matrix
	\[
		B=
		\left[
			\begin{array}{cc}
				1 + X^2 & X\\
				-X^3 & 1 - X^2
			\end{array}
		\right]
	\]
\end{frame}

% nextframe
\begin{frame}{Hawk - Key generation (Overview)}
	\textbf{Public key:} Hermitian matrix $Q \in R_n^{2\times 2}$.

	\textbf{Secret key:} Invertible matrix $B \in R_n^{2\times 2}$.\pause

	\bigskip
	\begin{itemize}
		\item Sample $2n$ integers to obtain polynomials
			\(
				f, g \in R_n.
			\)\pause
		\item Obtain solutions $F, G$ to the NTRU equation
			\[
				fG - gF = 1 \mod (X^n + 1).
			\]\pause
		\item The secret key is
			\[
				B \leftarrow
				\left[
					\begin{array}{cc}
						f & F\\
						g & G
					\end{array}
				\right].
			\]
		\item The public key is
			\[
				Q \leftarrow B^*B.
			\]
	\end{itemize}
\end{frame}

% nextframe
\begin{frame}{NTRUsolve (Overview)}
	\begin{itemize}
		\item Let $\phi \in \mathbb{Z}[X]$ be an irreducible polynomial with
			$n$ distinct roots over $\mathbb{C}$.
		\item Let $f, g \in \mathbb{Z}[X]$ of degree less than $n$.
		\item Let $q$ be a nonzero integer.
	\end{itemize}

	Our goal is to find integer polynomials $F$ and $G$ such that
	\[
		fG - gF = q \mod \phi.
	\]\pause
	By performing the \emph{Extended Division Algorithm} over polynomials, we
	obtain
	\(
		s, s', t, t' \in \mathbb{Z}[X]
	\)
	such that
	\[
		\left\{
			\begin{array}{l}
				sf + s'\phi = R_f \in \mathbb{Z}\\
				tg + t'\phi = R_g \in \mathbb{Z}
			\end{array}
		\right.
	\]
\end{frame}

% nextframe
\begin{frame}{NTRUsolve (Overview)}
	Next, by performing the same algorithm over integers, we obtain
	\(
		u, v \in \mathbb{Z}
	\)
	such that
	\[
		uR_f + vR_g = \delta
	\]
	where $\delta$ is the greatest common divisor of the integers $R_f$ and
	$R_g$.

	\bigskip
	Then if $\delta | q$,  all polynomials in the following relation have
	integer coefficients:
	\[
		\left(
			us\frac{q}{\delta}
		\right)f
		+
		\left(
			vt\frac{q}{\delta}
		\right)g
		= q
	\]
	and we obtain the solution
	\[
		\left\{
			\begin{array}{c}
				F= us\frac{q}{\delta}\\
				G= -vt\frac{q}{\delta}
			\end{array}
		\right.
	\]
\end{frame}

% nextframe
\begin{frame}{Hawk - Signing (Overview)}
	\textbf{Given:} Message $M$, Secret Key $B$, Salt length $\ell$.
	\begin{enumerate}
		\item Obtain the coefficients of two random polynomials by hashing
			the message with a uniformly sampled bit string called a
			\emph{salt}:
			\[
				\begin{array}{c}
					\textsf{salt} \in \{0,1\}^\ell \leftarrow
					\textsf{Rnd}(\ell)\\
					\mathbf{h} \leftarrow
					\textsf{H}(M \Vert \textsf{salt}) 
				\end{array}
			\]
		\item Interpret $\mathbf{h}$ as the corresponding
			\(
				\left[
				\begin{array}{l}
					h_0\\
					h_1
				\end{array}
				\right]
				\in R_n^2,
			\)
			multiply by the secret key $B$, and reduce the coefficients
			modulo 2:
			\[
				\mathbf{t} \leftarrow (B\mathbf{h}) \mod 2.
			\]
	\end{enumerate}
\end{frame}

% nextframe
\begin{frame}{Hawk - Signing (Overview)}
	\begin{enumerate}
	\addtocounter{enumi}{2}
	\item Sample a polynomial in the $2R_n^2-$coset of $\mathbf{t}$
		using the discrete gaussian distribution with parameter 
		$2\sigma_{\textsf{sign}}$:
		\[
			\begin{array}{c}
				\mathbf{x} \leftarrow D_{2\mathbb{Z}^{2n} +
				\mathbf{t}, 2\sigma_{\textsf{sign}}}\\
				{\color{cgreen}
					\mathbf{x} \in \mathbf{t} + 2R_n^2.
				}
			\end{array}
		\]
	\item If it is not short enough, restart:
		\[
			\texttt{if}\ \Vert\mathbf{x}\Vert >
			2n\cdot 4\sigma_{\textsf{verify}^2}\ 
			\texttt{restart}
		\]
	\item The secret short vector $\mathbf{w}$ will be the preimage of
		$\mathbf{x}$ under $B$. It is in the
		$2R_n^2$-coset of $\mathbf{h}$ and its $Q$-norm is the same as the
		euclidean norm of $\mathbf{x}$:
		\[
			\begin{array}{c}
				\mathbf{w} \leftarrow B^{-1}\mathbf{x}\\
				{\color{cgreen}
					\mathbf{w} \in \mathbf{h} + 2R_n^2.
				}
			\end{array}
		\]
	\end{enumerate}
\end{frame}

% nextframe
\begin{frame}{Hawk Signing (Overview)}
	\begin{enumerate}
		\addtocounter{enumi}{5}
		\item The signature consists of the salt together with a vector
			$\mathbf{s}\in R_n^2$, such that the secret vector
			$\mathbf{w}$ can be publicly recovered from it and
			$\mathbf{h}$:
		\[
			\begin{array}{c}
				\mathbf{s} \leftarrow \frac{1}{2} (\mathbf{h}-\mathbf{w})\\
				\textsf{sig} \leftarrow (\textsf{salt}, \mathbf{s}).
			\end{array}
		\]
	\end{enumerate}
\end{frame}

% nextframe
\begin{frame}{Hawk Signing - \emph{Example}}
	
	\bigskip
	{\large \color{blue} (Step 1)}

	For $n= 4$, let the secret key be
	\[
		B=
		\left[
			\begin{array}{cc}
				1 + X^2 & X\\
				-X^3 & 1 - X^2
			\end{array}
		\right]
	\]
	and let the hash of the message and salt $\mathsf{H}(M\Vert \textsf{salt})$
	be 
	\[
		\mathbf{h}= 10111100.
	\]
	Interpreting $\mathbf{h}$ as an element of $R_n^2$ gives
	\[
		\mathbf{h} =
		\left[
			\begin{array}{c}
				1 + X^2 + X^3\\
				1 + X
			\end{array}
		\right]
	\]
\end{frame}

% nextframe
\begin{frame}{Hawk Signing - \emph{Example}}
	
	\bigskip
	{\large \color{blue} (Step 2)}

	Multiplying $\mathbf{h}$ by the secret key gives
	\[
		\begin{array}{c}
			B\mathbf{h}=
			\left[
				\begin{array}{cc}
					1 + X^2 & X\\
					-X^3 & 1 - X^2
				\end{array}
			\right]
			\left[
				\begin{array}{c}
					1 + X^2 + X^3\\
					1 + X
				\end{array}
			\right]\\
			 \\
			=
			\left[
				\begin{array}{c}
					3X^2 + X^3\\
					1 + 2X - 2X^3
				\end{array}
			\right]
			\mod (X^4 + 1)
		\end{array}
	\]

	Letting $\mathbf{t}$ be the result of taking residue modulo 2 of the
	coefficients of $B\mathbf{h}$, we obtain
	\[
		\mathbf{t}=
		\left[
			\begin{array}{c}
				X^2 + X^3\\
				1
			\end{array}
		\right]
	\]
	and we have
	\(
		\mathbf{t} \sim B\mathbf{h} \mod 2R_n^2.
	\)
\end{frame}

% nextframe
\begin{frame}{Hawk Signing - Example}

	{\large \color{blue} (Step 3)}

	Interpreting $\mathbf{t}$ as a vector gives
	\[
		\mathbf{t} =
		\left[0, 0, 1, 1, 1, 0, 0, 0\right]^{\mathsf{t}}
	\]
	We now perform discrete gaussian sampling on the lattice
	\(
		2\mathbb{Z}^{2n} + \mathbf{t},
	\)
	denoted
	\[
		\mathbf{x} \leftarrow D_{2\mathbb{Z}^{2n} + \mathbf{t}},
	\]
	and suppose we obtain
	\[
		\begin{array}{c}
			\mathbf{x} = \mathbf{t} +
			\left[2, 0, -2, 0, 2, 0, -2, 0\right]^{\mathsf{t}}\\
			=
			[2, 0, -1, 1, 3, 0, -2, 0]^\mathsf{t}
		\end{array}
	\]
\end{frame}

% nextframe
\begin{frame}{Hawk Signing - Example}

	{\large \color{blue} (Step 4)}

	Suppose our verification standard deviation is
	\[
		\sigma_{\textsf{verify}}= 1.425.
	\]
	Then the test of whether or not $\mathbf{x}$ is short enough consists of
	checking if the inequality
	\[
		\Vert\mathbf{x}\Vert^2 \leq
		4\sigma_{\textsf{verify}}^2\cdot 2n
	\]
	holds, which in this case is
	\[
		19 \leq 64.98
	\]
	and therefore we sampled a short enough vector.
\end{frame}

% nextframe
\begin{frame}{Hawk Signing - Example}

	{\large \color{blue} (Step 5)}

	Interpreting $\mathbf{x}$ as an element of $R_n^2$ gives
	\[
		\mathbf{x} =
		\left[
			\begin{array}{c}
				2 - X^2 + X^3\\
				3 - 2X^2
			\end{array}
		\right]
	\]
	and the $Q$-short vector $\mathbf{w}$ in the coset of $\mathbf{h}$ is
	obtained as
	\[
		\begin{array}{c}
			\mathbf{w}= B^{-1}\mathbf{x}\\
			 \\
			=
			\left[
				\begin{array}{cc}
					1-X^2 & -X\\
					X^3 & 1+X^2
				\end{array}
			\right]
			\left[
				\begin{array}{c}
					2-X^2+X^3\\
					3-2X^2
				\end{array}
			\right]\\
			 \\
			=
			\left[
				\begin{array}{c}
					1 - 2X - 3X^2 + 3X^3\\
					5 + X + 2X^3
				\end{array}
			\right]
		\end{array}
	\]
\end{frame}

\begin{frame}{Hawk Signing - Example}

	{\large \color{blue} (Step 6)}

	Then the signature vector is computed as
	\[
		\begin{array}{c}
			\mathbf{s}= \frac{1}{2}(\mathbf{h} - \mathbf{w})\\
			=
			\frac{1}{2}
			\left(
				\left[
					\begin{array}{c}
						1 + X^2 + X^3\\
						1 + X
					\end{array}
				\right]
				-
				\left[
					\begin{array}{c}
						1 - 2X - 3X^2 + 3X^3\\
						5 + X + 2X^3
					\end{array}
				\right]
			\right)\\
			=
			\frac{1}{2}
			\left[
				\begin{array}{c}
					-2X + 4X^2 - 2X^3\\
					-4 - 2X^3
				\end{array}
			\right]\\
			=
			\left[
				\begin{array}{c}
					-X + 2X^2 - X^3\\
					-2 - X^3
				\end{array}
			\right]
		\end{array}
	\]
	and we return
	\[
		(\mathbf{s}, \textsf{salt}).
	\]
\end{frame}

% nextframe
\begin{frame}{Hawk - Verifying (Overview)}
	\textbf{Given:} Message $M$, public key $Q$, signature
	\(
		(\mathbf{s}, \textsf{salt}).
	\)
	\begin{enumerate}
		\item Recompute $\mathbf{h}$ from $M$ and the salt:
			\[
				\mathbf{h} \leftarrow
				\mathsf{H}(M \Vert \textsf{salt})
			\]
		\item Recover the short vector $\mathbf{w}$ from $\mathbf{h}$
			and the signature vector $\mathbf{s}$:
			\[
				\mathbf{w} \leftarrow
				\mathbf{h} - 2\mathbf{s}
			\]
		\item Check if $\mathbf{w}$ is $Q$-short enough, this check
			references step 4 of the signing algorithm:
			\[
				\texttt{return}\ \ 
				\Vert\mathbf{w}\Vert^2 \leq
				4\sigma_{\textsf{verify}}^2\cdot 2n.
			\]
	\end{enumerate}
\end{frame}

\end{document}
