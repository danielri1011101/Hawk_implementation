\input{preamble}

\begin{document}
\maketitle

\section{January 14 -- ?}
I was about to learn (in bird's eye view) the working of the \texttt{verify}
subroutine.

However, I started reviewing the norms and inner products.

\textbf{Question.} Are inner products closed under scalar multiplication? Yes,
if and only if the scalar is positive.

\bigskip
\textbf{Question}(January 24). Why does
\(
	\overline{f(\gamma)} = f(\bar{\gamma})
\)
for all $n$ distinct (possibly complex) roots of
\(
	\phi \in \mathbb{Q}[X]
\)
imply
\(
	f \in \mathbb{R}[X]
\)?

\section{NTRUsolve}
The NTRU equation is
\[
	fG - gF = q \mod X^n + 1
\]
where $f$ and $g$ are given, and the idea is to solve for $F$ and $G$. All the
polynomials in the equation are in
\(
	\mathbb{Z}[X]/\encl{X^n + 1}.
\)

\subsection{Resultants} The resultant of two polynomials $p$ and $q$ is zero if and
only if they have a common root. Thus one way to define it is
\[
	\mathrm{Res}(p,q)= p_n^m\prod_{i=0}^{n-1}q(\gamma_i)
\]
where the $\gamma_i$ are the roots of $p$ and $m$ is the degree of $q$.

Given a monic polynomial
\(
	\phi \in \mathbb{C}[X]
\)
of degree $n$ and a polynomial
\(
	p \in \mathbb{C}[X]/\encl{\phi}
\)
we denote by $\rema{p}{\phi}$ the matrix whose $j-$th row consists of the
coefficients of
\(
	X^{j-1}p \mod \phi,
\)
as in
\[
	\rema{p}{\phi} =
	\left[
		\begin{array}{c}
			p \mod \phi\\
			Xp \mod \phi\\
			\vdots\\
			X^{n-1}p \mod \phi
		\end{array}
	\right]
\]

\bigskip
Recall that if
\(
	\vec{x}= x_0, x_1, \ldots, x_{m-1}
\)

is a sequence of numbers, its $n-$th \emph{Vandermonde matrix} is given by

\[
	V(\vec{x},n)^i_j= x_i^j.
\]

In particular, given a polynomial $\phi$ with $n$ distinct roots over $\mathbb{C}$,
we defie $V_\phi$ as the $n-$th Vandermonde matrix of its roots:

\[
	V_\phi=
	\left[
		\begin{array}{ccccc}
			1 & \alpha_0 & \alpha_0^2 & \ldots & \alpha_0^{n-1}\\
			1 & \alpha_1 & \alpha_1^2 & \ldots & \alpha_1^{n-1}\\
			\vdots & \vdots & \ddots & & \vdots \\
			 1 & \alpha_{n-1} & \alpha_{n-1}^2 & \ldots & \alpha_{n-1}^{n-1}\\
		\end{array}
	\right]
\]

\bigskip
\begin{thm}
	If the polynomial $g$ has $n$ distinct roots over $\mathbb{C}$ and $f$ has
	degree less than $n$, then
	\[
		\mathrm{Res}(g,f) = \det \rema{f}{g}.
	\]
\end{thm}

\begin{proof}
	Let $D$ denote the diagonal matrix whose entries are the evaluations of $f$
	at the roots of $g$. Then upon inspection it is easily seen that
	\[
			V_g (\rema{f}{g})^{\textsf{t}} = D V_g,
	\]
	and therefore
	\[
		(\rema{f}{g})^{\textsf{t}} = V_g^{-1} D V_g.
	\]
	The result then follows from the fact that
	\(
		\det\rema{f}{g} = \det(\rema{f}{g})^{\textsf{t}}
	\)
	and from the multiplicativity of the determinant.
\end{proof}

\section{HawkSign example}
	{\large \bf (Step 1)}

	For $n= 4$, let the secret key be
	\[
		B=
		\left[
			\begin{array}{cc}
				1 + X^2 & X\\
				-X^3 & 1 - X^2
			\end{array}
		\right]
	\]
	and let the hash of the message and salt $\mathsf{H}(M\Vert \textsf{salt})$
	be 
	\[
		\mathbf{h}= 10111100.
	\]
	Interpreting $\mathbf{h}$ as an element of $R_n^2$ gives
	\[
		\mathbf{h} =
		\left[
			\begin{array}{c}
				1 + X^2 + X^3\\
				1 + X
			\end{array}
		\right]
	\]

	
	\bigskip
	{\large \bf (Step 2)}

	Multiplying $\mathbf{h}$ by the secret key gives
	\[
		\begin{array}{c}
			B\mathbf{h}=
			\left[
				\begin{array}{cc}
					1 + X^2 & X\\
					-X^3 & 1 - X^2
				\end{array}
			\right]
			\left[
				\begin{array}{c}
					1 + X^2 + X^3\\
					1 + X
				\end{array}
			\right]\\
			 \\
			=
			\left[
				\begin{array}{c}
					3X^2 + X^3\\
					1 + 2X - 2X^3
				\end{array}
			\right]
			\mod (X^4 + 1)
		\end{array}
	\]

	Letting $\mathbf{t}$ be the result of taking residue modulo 2 of the
	coefficients of $B\mathbf{h}$, we obtain
	\[
		\mathbf{t}=
		\left[
			\begin{array}{c}
				X^2 + X^3\\
				1
			\end{array}
		\right]
	\]
	and we have
	\(
		\mathbf{t} \sim B\mathbf{h} \mod 2R_n^2.
	\)

	{\large \bf (Step 3)}

	Interpreting $\mathbf{t}$ as a vector gives
	\[
		\mathbf{t} =
		\left[0, 0, 1, 1, 1, 0, 0, 0\right]^{\mathsf{t}}
	\]
	We now perform discrete gaussian sampling on the lattice
	\(
		2\mathbb{Z}^{2n} + \mathbf{t},
	\)
	denoted
	\[
		\mathbf{x} \leftarrow D_{2\mathbb{Z}^{2n} + \mathbf{t}},
	\]
	and suppose we obtain
	\[
		\begin{array}{c}
			\mathbf{x} = \mathbf{t} +
			\left[2, 0, -2, 0, 2, 0, -2, 0\right]^{\mathsf{t}}\\
			=
			[2, 0, -1, 1, 3, 0, -2, 0]^\mathsf{t}
		\end{array}
	\]

	{\large \bf (Step 4)}

	Suppose our verification standard deviation is
	\[
		\sigma_{\textsf{verify}}= 1.425.
	\]
	Then the test of whether or not $\mathbf{x}$ is short enough consists of
	checking if the inequality
	\[
		\Vert\mathbf{x}\Vert^2 \leq
		4\sigma_{\textsf{verify}}^2\cdot 2n
	\]
	holds, which in this case is
	\[
		19 \leq 64.98
	\]
	and therefore we sampled a short enough vector.

	{\large \bf (Step 5)}

	Interpreting $\mathbf{x}$ as an element of $R_n^2$ gives
	\[
		\mathbf{x} =
		\left[
			\begin{array}{c}
				2 - X^2 + X^3\\
				3 - 2X^2
			\end{array}
		\right]
	\]
	and the $Q$-short vector $\mathbf{w}$ in the coset of $\mathbf{h}$ is
	obtained as
	\[
		\begin{array}{c}
			\mathbf{w}= B^{-1}\mathbf{x}\\
			 \\
			=
			\left[
				\begin{array}{cc}
					1-X^2 & -X\\
					X^3 & 1+X^2
				\end{array}
			\right]
			\left[
				\begin{array}{c}
					2-X^2+X^3\\
					3-2X^2
				\end{array}
			\right]\\
			 \\
			=
			\left[
				\begin{array}{c}
					1 - 2X - 3X^2 + 3X^3\\
					5 + X + 2X^3
				\end{array}
			\right]
		\end{array}
	\]

	{\large \bf (Step 6)}

	Then the signature vector is computed as
	\[
		\begin{array}{c}
			\mathbf{s}= \frac{1}{2}(\mathbf{h} - \mathbf{w})\\
			=
			\frac{1}{2}
			\left(
				\left[
					\begin{array}{c}
						1 + X^2 + X^3\\
						1 + X
					\end{array}
				\right]
				-
				\left[
					\begin{array}{c}
						1 - 2X - 3X^2 + 3X^3\\
						5 + X + 2X^3
					\end{array}
				\right]
			\right)\\
			=
			\frac{1}{2}
			\left[
				\begin{array}{c}
					-2X + 4X^2 - 2X^3\\
					-4 - 2X^3
				\end{array}
			\right]\\
			=
			\left[
				\begin{array}{c}
					-X + 2X^2 - X^3\\
					-2 - X^3
				\end{array}
			\right]
		\end{array}
	\]
	and we return
	\[
		(\mathbf{s}, \textsf{salt}).
	\]
\end{document}
